<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <!-- Meta tag para definir o conjunto de caracteres como UTF-8 -->
    <meta charset="UTF-8">
    
    <!-- Meta tag para responsividade em dispositivos m√≥veis -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- T√≠tulo da p√°gina exibido na aba do navegador -->
    <title>Inkly - Desenhe! üé®</title>
    
    <!-- Importa√ß√£o do TailwindCSS via CDN para estiliza√ß√£o -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Script para passar o ID do jogador do backend para o frontend -->
    <script>
        // Vari√°vel global que armazena o ID do jogador vindo do template Django/Flask
        window.PLAYER_ID = "{{ player.id }}";
    </script>
    
    <!-- Estilos CSS customizados -->
    <style>
        /* Importa a fonte Fredoka do Google Fonts com diferentes pesos */
        @import url('https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600;700&display=swap');
        
        /* Define a fonte Fredoka para todos os elementos */
        * { font-family: 'Fredoka', sans-serif; }
        
        /* Estilos do canvas de desenho */
        canvas { 
            cursor: crosshair; /* Cursor em formato de mira para desenhar */
            touch-action: none; /* Desabilita a√ß√µes de toque padr√£o do navegador */
            display: block; /* Remove espa√ßo extra embaixo do canvas */
            max-width: 100%; /* Faz o canvas responsivo */
            height: auto; /* Altura autom√°tica para manter propor√ß√£o */
            background-color: white; /* Fundo branco para o canvas */
            margin: 0 auto; /* Centraliza o canvas horizontalmente */
        }
        
        /* Anima√ß√£o de confete que cai do topo at√© o fundo da tela */
        @keyframes confetti {
            0% { 
                transform: translateY(-100vh) rotate(0deg); /* Inicia acima da tela */
                opacity: 1; /* Totalmente vis√≠vel */
            }
            100% { 
                transform: translateY(100vh) rotate(360deg); /* Termina abaixo da tela com rota√ß√£o completa */
                opacity: 0; /* Desaparece gradualmente */
            }
        }
        
        /* Classe para elementos de confete */
        .confetti {
            position: fixed; /* Posicionamento fixo na tela */
            width: 10px; /* Largura do confete */
            height: 10px; /* Altura do confete */
            animation: confetti 3s linear; /* Aplica anima√ß√£o de 3 segundos */
            pointer-events: none; /* N√£o interfere com cliques do mouse */
            z-index: 1000; /* Fica acima de todos os outros elementos */
        }
    </style>
</head>

<!-- Corpo da p√°gina com gradiente de fundo roxo para laranja -->
<body class="bg-gradient-to-br from-purple-500 via-pink-500 to-orange-400 min-h-screen p-4">
    <!-- Container principal com largura m√°xima de 7xl -->
    <div class="max-w-7xl mx-auto">
        
        <!-- Cabe√ßalho com informa√ß√µes do jogador -->
        <div class="bg-white rounded-3xl shadow-2xl p-6 mb-4 flex justify-between items-center">
            <!-- Se√ß√£o esquerda: Logo e nome do jogador -->
            <div>
                <!-- T√≠tulo do jogo -->
                <h1 class="text-3xl font-bold text-purple-600">üé® Inkly</h1>
                
                <!-- Sauda√ß√£o personalizada com nome do jogador vindo do backend -->
                <p class="text-gray-600">Ol√°, <span id="playerName">{{ player.name }}</span>!</p>
            </div>
            
            <!-- Se√ß√£o direita: Estat√≠sticas do jogador -->
            <div class="flex gap-4 items-center">
                <!-- Card de N√≠vel -->
                <div class="text-center">
                    <div class="text-2xl font-bold text-purple-600" id="level">Nv. {{ player.level }}</div>
                    <div class="text-sm text-gray-500">N√≠vel</div>
                </div>
                
                <!-- Card de Experi√™ncia -->
                <div class="text-center">
                    <div class="text-2xl font-bold text-pink-600" id="xp">{{ player.xp }} XP</div>
                    <div class="text-sm text-gray-500">Experi√™ncia</div>
                </div>
                
                <!-- Card de Sequ√™ncia (streak) -->
                <div class="text-center">
                    <div class="text-2xl font-bold text-orange-600" id="streak">{{ player.streak }}üî•</div>
                    <div class="text-sm text-gray-500">Sequ√™ncia</div>
                </div>
            </div>
        </div>

        <!-- Grid principal: 1 coluna em mobile, 4 colunas em telas grandes -->
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-4">
            
            <!-- SIDEBAR ESQUERDA: Ferramentas de desenho (1 coluna) -->
            <div class="lg:col-span-1">
                
                <!-- Card de Pinc√©is -->
                <div class="bg-white rounded-2xl shadow-xl p-4 mb-4">
                    <!-- T√≠tulo da se√ß√£o de pinc√©is -->
                    <h3 class="font-bold text-gray-800 mb-3 flex items-center">
                        <span class="text-2xl mr-2">üñåÔ∏è</span> Pinc√©is
                    </h3>
                    
                    <!-- Container para bot√µes de pinc√©is (preenchido via JavaScript) -->
                    <div class="grid grid-cols-2 gap-2" id="brushes"></div>
                </div>

                <!-- Card de Cores -->
                <div class="bg-white rounded-2xl shadow-xl p-4 mb-4">
                    <!-- T√≠tulo da se√ß√£o de cores -->
                    <h3 class="font-bold text-gray-800 mb-3 flex items-center">
                        <span class="text-2xl mr-2">üé®</span> Cores
                    </h3>
                    
                    <!-- Paleta de cores em grid 6x6 (preenchida via JavaScript) -->
                    <div class="grid grid-cols-6 gap-2 mb-3" id="colorPalette"></div>
                    
                    <!-- Controles de gradiente RGB customizado -->
                    <div class="mt-3">
                        <label class="text-sm text-gray-600 block mb-1">Gradiente RGB</label>
                        
                        <!-- Slider para controlar o canal R (Red/Vermelho) -->
                        <div class="flex gap-2">
                            <input type="range" id="colorR" min="0" max="255" value="0" class="w-full">
                            <span class="text-xs font-mono w-8" id="rVal">0</span>
                        </div>
                        
                        <!-- Slider para controlar o canal G (Green/Verde) -->
                        <div class="flex gap-2">
                            <input type="range" id="colorG" min="0" max="255" value="0" class="w-full">
                            <span class="text-xs font-mono w-8" id="gVal">0</span>
                        </div>
                        
                        <!-- Slider para controlar o canal B (Blue/Azul) -->
                        <div class="flex gap-2">
                            <input type="range" id="colorB" min="0" max="255" value="0" class="w-full">
                            <span class="text-xs font-mono w-8" id="bVal">0</span>
                        </div>
                        
                        <!-- Preview da cor RGB selecionada -->
                        <div class="mt-2 h-8 rounded-lg border-2" id="rgbPreview"></div>
                    </div>
                </div>

                <!-- Card de Tamanho do Pincel -->
                <div class="bg-white rounded-2xl shadow-xl p-4">
                    <h3 class="font-bold text-gray-800 mb-3">Tamanho</h3>
                    
                    <!-- Slider para controlar o tamanho do pincel (2-40px) -->
                    <input type="range" id="brushSize" min="2" max="40" value="8" class="w-full">
                    
                    <!-- Display do valor atual do tamanho -->
                    <div class="text-center text-gray-600 mt-2" id="sizeVal">8px</div>
                </div>
            </div>

            <!-- √ÅREA PRINCIPAL: Canvas e controles (3 colunas) -->
            <div class="lg:col-span-3">
                
                <!-- Card do Prompt (palavra a ser desenhada) -->
                <div class="bg-white rounded-2xl shadow-xl p-6 mb-4" id="promptCard">
                    <div class="text-center">
                        <!-- Texto do prompt que muda dinamicamente -->
                        <h2 class="text-4xl font-bold text-gray-800 mb-2" id="prompt">Carregando...</h2>
                        
                        <div class="flex justify-center items-center gap-4">
                            <!-- Timer de contagem regressiva -->
                            <div class="text-6xl font-bold text-purple-600" id="timer">20</div>
                            
                            <!-- Bot√£o para iniciar o desenho -->
                            <button onclick="startDrawing()" id="startBtn" 
                                class="bg-gradient-to-r from-green-400 to-blue-500 text-white font-bold py-4 px-8 rounded-xl hover:scale-105 transform transition-all">
                                ‚ñ∂Ô∏è Come√ßar!
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Card do Canvas -->
                <div class="bg-white rounded-2xl shadow-xl p-4">
                    <!-- Cabe√ßalho com t√≠tulo e bot√£o de limpar -->
                    <div class="flex justify-between mb-3">
                        <h3 class="font-bold text-gray-800">Sua Tela ‚ú®</h3>
                        
                        <!-- Bot√£o para limpar o canvas -->
                        <button onclick="clearCanvas()" class="text-red-500 hover:text-red-700 font-semibold">
                            üóëÔ∏è Limpar
                        </button>
                    </div>
                    
                    <!-- Canvas principal onde o usu√°rio desenha (800x600px) -->
                    <!-- touch-action: none previne scroll ao desenhar no mobile -->
                    <!-- select-none previne sele√ß√£o acidental de texto -->
                    <canvas id="canvas" width="800" height="600"
                        class="w-full border-4 border-purple-300 rounded-xl bg-white touch-none select-none"></canvas>
                    
                    <!-- Bot√µes de a√ß√£o -->
                    <div class="mt-3 flex gap-2">
                        <!-- Bot√£o para enviar o desenho (desabilitado at√© iniciar) -->
                        <button onclick="submitDrawing()" id="submitBtn" disabled
                            class="flex-1 bg-gradient-to-r from-purple-500 to-pink-500 text-white font-bold py-3 px-6 rounded-xl hover:scale-105 transform transition-all disabled:opacity-50 disabled:cursor-not-allowed">
                            ‚úÖ Enviar Desenho
                        </button>
                        
                        <!-- Bot√£o para pular o prompt atual -->
                        <button onclick="skipPrompt()"
                            class="bg-gray-300 text-gray-700 font-bold py-3 px-6 rounded-xl hover:bg-gray-400">
                            ‚è≠Ô∏è Pular
                        </button>
                    </div>
                </div>

                <!-- Card do Mascote IA com mensagens din√¢micas -->
                <div class="mt-4 bg-white rounded-2xl shadow-xl p-6 text-center" id="aiMascot">
                    <!-- Emoji do mascote que muda de acordo com o contexto -->
                    <div class="text-6xl mb-2" id="aiEmoji">ü§ñ</div>
                    
                    <!-- Mensagem da IA que muda dinamicamente -->
                    <p class="text-gray-600 text-lg" id="aiMessage">Esperando seu desenho...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL DE RESULTADO (aparece ap√≥s enviar o desenho) -->
    <!-- Inicialmente escondido, mostra quando h√° resultado -->
    <div id="resultModal" class="fixed inset-0 bg-black bg-opacity-75 hidden items-center justify-center z-50">
        <!-- Container do modal centralizado -->
        <div class="bg-white rounded-3xl shadow-2xl p-8 max-w-2xl w-full mx-4">
            <div class="text-center">
                <!-- Emoji de resultado (muda baseado no sucesso) -->
                <div class="text-8xl mb-4" id="resultEmoji">üéâ</div>
                
                <!-- T√≠tulo do resultado -->
                <h2 class="text-4xl font-bold mb-4" id="resultTitle">Incr√≠vel!</h2>
                
                <!-- Mensagem de feedback -->
                <p class="text-2xl text-gray-600 mb-6" id="resultMessage"></p>
                
                <!-- Se√ß√£o de palpites da IA -->
                <div class="bg-purple-50 rounded-2xl p-6 mb-6">
                    <h3 class="font-bold text-gray-800 mb-3">A IA pensou:</h3>
                    
                    <!-- Lista de palpites da IA (preenchida via JavaScript) -->
                    <div id="aiGuesses" class="space-y-2"></div>
                </div>
                
                <!-- Grid com pontua√ß√£o e XP ganhos -->
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <!-- Card de pontos ganhos -->
                    <div class="bg-gradient-to-r from-purple-100 to-pink-100 rounded-xl p-4">
                        <div class="text-3xl font-bold text-purple-600" id="scoreVal">+0</div>
                        <div class="text-sm text-gray-600">Pontos</div>
                    </div>
                    
                    <!-- Card de XP ganho -->
                    <div class="bg-gradient-to-r from-blue-100 to-green-100 rounded-xl p-4">
                        <div class="text-3xl font-bold text-blue-600" id="xpVal">+0 XP</div>
                        <div class="text-sm text-gray-600">Experi√™ncia</div>
                    </div>
                </div>
                
                <!-- Se√ß√£o de conquistas (aparece quando h√° conquistas novas) -->
                <div id="achievementsDisplay" class="mb-6 hidden">
                    <h3 class="font-bold text-yellow-600 mb-2">üèÜ Conquistas Desbloqueadas!</h3>
                    
                    <!-- Lista de conquistas desbloqueadas -->
                    <div id="achievementsList"></div>
                </div>
                
                <!-- Bot√£o para ir para o pr√≥ximo desenho -->
                <button onclick="nextRound()"
                    class="w-full bg-gradient-to-r from-purple-500 to-pink-500 text-white font-bold py-4 px-8 rounded-xl text-xl hover:scale-105 transform transition-all">
                    ‚û°Ô∏è Pr√≥ximo Desenho
                </button>
            </div>
        </div>
    </div>

    <!-- Importa√ß√£o do arquivo JavaScript principal do jogo -->
    <script src="/static/game.js"></script>
</body>
</html>

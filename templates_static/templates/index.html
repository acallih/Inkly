<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <!-- Define a codifica√ß√£o de caracteres como UTF-8 para suportar caracteres especiais -->
    <meta charset="UTF-8">
    <!-- Configura a viewport para responsividade em dispositivos m√≥veis -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- T√≠tulo da p√°gina que aparece na aba do navegador -->
    <title>Inkly - Desenhe com IA! üé®</title>
    <!-- Importa o framework Tailwind CSS via CDN para estiliza√ß√£o r√°pida -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Importa a fonte Fredoka do Google Fonts com diferentes pesos */
        @import url('https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600;700&display=swap');
        /* Define a fonte Fredoka como padr√£o para todos os elementos */
        * { font-family: 'Fredoka', sans-serif; }
        
        /* Anima√ß√£o de flutua√ß√£o que move o elemento para cima e para baixo */
        @keyframes float {
            0%, 100% { transform: translateY(0px); } /* Posi√ß√£o inicial e final */
            50% { transform: translateY(-20px); } /* Posi√ß√£o no meio da anima√ß√£o (sobe 20px) */
        }
        
        /* Anima√ß√£o de brilho que alterna a intensidade da sombra */
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 20px rgba(168, 85, 247, 0.4); } /* Brilho suave */
            50% { box-shadow: 0 0 40px rgba(168, 85, 247, 0.8); } /* Brilho intenso */
        }
        
        /* Classe que aplica a anima√ß√£o de flutua√ß√£o continuamente */
        .float { animation: float 3s ease-in-out infinite; }
        /* Classe que aplica a anima√ß√£o de brilho continuamente */
        .glow { animation: glow 2s ease-in-out infinite; }
        /* Gradiente roxo/violeta para o fundo da p√°gina */
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
    </style>
</head>
<body class="gradient-bg min-h-screen flex items-center justify-center p-4">
    <!-- Elemento de √°udio para m√∫sica de fundo (loop = repetir continuamente) -->
    <audio id="bgMusic" loop>
        <!-- Fonte do arquivo de √°udio MP3 -->
        <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
    </audio>

    <!-- Container principal com largura m√°xima e centralizado -->
    <div class="max-w-2xl w-full">
        <!-- Cabe√ßalho com t√≠tulo e subt√≠tulo (com anima√ß√£o de flutua√ß√£o) -->
        <div class="text-center mb-8 float">
            <!-- T√≠tulo principal do jogo com emoji -->
            <h1 class="text-7xl font-bold text-white mb-2">üé® Inkly</h1>
            <!-- Subt√≠tulo explicativo -->
            <p class="text-2xl text-purple-200">Desenhe e surpreenda a IA!</p>
        </div>

        <!-- Card principal branco com sombra e efeito de brilho -->
        <div class="bg-white rounded-3xl shadow-2xl p-8 mb-6 glow">
            <!-- Se√ß√£o de boas-vindas -->
            <div class="text-center mb-6">
                <!-- Emojis decorativos grandes -->
                <div class="text-6xl mb-4">ü§ñ‚ú®</div>
                <!-- T√≠tulo de boas-vindas -->
                <h2 class="text-3xl font-bold text-gray-800 mb-2">Bem-vindo ao Inkly!</h2>
                <!-- Descri√ß√£o do jogo -->
                <p class="text-gray-600 text-lg">
                    Uma IA vai tentar adivinhar o que voc√™ est√° desenhando.<br>
                    Ser√° que consegue confundir ou impressionar ela? üé≠
                </p>
            </div>

            <!-- Se√ß√£o do formul√°rio de nome do jogador -->
            <div class="mb-6">
                <!-- Label do campo de entrada -->
                <label class="block text-gray-700 font-semibold mb-2 text-lg">Como voc√™ se chama?</label>
                <!-- Campo de texto para o jogador digitar o nome (m√°ximo 20 caracteres) -->
                <input type="text" id="playerName" placeholder="Digite seu nome..."
                    class="w-full px-6 py-4 text-lg border-4 border-purple-300 rounded-2xl focus:outline-none focus:border-purple-500 transition-all"
                    maxlength="20">
            </div>

            <!-- Bot√£o principal para iniciar o jogo -->
            <button onclick="startGame()"
                class="w-full bg-gradient-to-r from-purple-500 to-pink-500 text-white font-bold py-5 px-8 rounded-2xl text-xl hover:scale-105 transform transition-all shadow-lg hover:shadow-xl">
                üöÄ Come√ßar a Desenhar!
            </button>

            <!-- Se√ß√£o de controle de m√∫sica -->
            <div class="mt-6 text-center">
                <!-- Bot√£o para ativar/pausar m√∫sica de fundo -->
                <button onclick="toggleMusic()" id="musicBtn"
                    class="text-purple-600 hover:text-purple-800 font-semibold flex items-center justify-center mx-auto">
                    <!-- Emoji de nota musical -->
                    <span class="text-2xl mr-2">üéµ</span>
                    <!-- Texto do status da m√∫sica -->
                    <span id="musicStatus">Ativar M√∫sica</span>
                </button>
            </div>
        </div>

        <!-- Grid de cards de recursos/funcionalidades (3 colunas em desktop, 1 em mobile) -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <!-- Card 1: Pinc√©is M√°gicos -->
            <div class="bg-white bg-opacity-90 rounded-2xl p-6 text-center transform hover:scale-105 transition-all">
                <!-- Emoji do pincel -->
                <div class="text-4xl mb-2">üé®</div>
                <!-- T√≠tulo do recurso -->
                <h3 class="font-bold text-gray-800 mb-1">Pinc√©is M√°gicos</h3>
                <!-- Descri√ß√£o breve -->
                <p class="text-sm text-gray-600">Desbloqueie pinc√©is especiais</p>
            </div>
            <!-- Card 2: Conquistas -->
            <div class="bg-white bg-opacity-90 rounded-2xl p-6 text-center transform hover:scale-105 transition-all">
                <!-- Emoji do trof√©u -->
                <div class="text-4xl mb-2">üèÜ</div>
                <!-- T√≠tulo do recurso -->
                <h3 class="font-bold text-gray-800 mb-1">Conquistas</h3>
                <!-- Descri√ß√£o breve -->
                <p class="text-sm text-gray-600">Desbloqueie trof√©us √©picos</p>
            </div>
            <!-- Card 3: Multiplayer -->
            <div class="bg-white bg-opacity-90 rounded-2xl p-6 text-center transform hover:scale-105 transition-all">
                <!-- Emoji de aperto de m√£o -->
                <div class="text-4xl mb-2">ü§ù</div>
                <!-- T√≠tulo do recurso -->
                <h3 class="font-bold text-gray-800 mb-1">Multiplayer</h3>
                <!-- Descri√ß√£o breve -->
                <p class="text-sm text-gray-600">Desafie seus amigos</p>
            </div>
        </div>

        <!-- Rodap√© com cr√©ditos -->
        <div class="text-center mt-8 text-white text-sm">
            <!-- Texto indicando que usa Google Gemini AI -->
            <p>‚ú® Powered by Google Gemini AI ‚ú®</p>
        </div>
    </div>

    <script>
        // Vari√°vel para controlar se a m√∫sica est√° tocando ou n√£o
        let musicPlaying = false;
        // Refer√™ncia ao elemento de √°udio HTML
        const music = document.getElementById('bgMusic');

        /**
         * Fun√ß√£o para alternar entre tocar e pausar a m√∫sica de fundo
         * Atualiza o estado da m√∫sica e a interface do bot√£o
         */
        function toggleMusic() {
            // Inverte o estado da m√∫sica (true -> false ou false -> true)
            musicPlaying = !musicPlaying;
            
            // Se a m√∫sica deve tocar
            if (musicPlaying) {
                // Inicia a reprodu√ß√£o do √°udio
                music.play();
                // Atualiza o texto do bot√£o
                document.getElementById('musicStatus').textContent = 'Pausar M√∫sica';
                // Atualiza o emoji do bot√£o (nota musical -> alto-falante)
                document.getElementById('musicBtn').innerHTML = '<span class="text-2xl mr-2">üîä</span><span id="musicStatus">Pausar M√∫sica</span>';
            } else {
                // Pausa a reprodu√ß√£o do √°udio
                music.pause();
                // Atualiza o texto do bot√£o
                document.getElementById('musicStatus').textContent = 'Ativar M√∫sica';
                // Atualiza o emoji do bot√£o (alto-falante -> nota musical)
                document.getElementById('musicBtn').innerHTML = '<span class="text-2xl mr-2">üéµ</span><span id="musicStatus">Ativar M√∫sica</span>';
            }
        }

        /**
         * Fun√ß√£o ass√≠ncrona para iniciar o jogo
         * Valida o nome do jogador, cria uma sess√£o no servidor e redireciona para a p√°gina do jogo
         */
        async function startGame() {
            // Obt√©m o nome do jogador e remove espa√ßos em branco no in√≠cio e fim
            const name = document.getElementById('playerName').value.trim();
            
            // Valida se o nome foi preenchido
            if (!name) {
                // Exibe mensagem de erro se o nome estiver vazio
                alert('Por favor, digite seu nome! üòä');
                return; // Interrompe a execu√ß√£o da fun√ß√£o
            }

            try {
                // Obt√©m refer√™ncia ao bot√£o que foi clicado
                const btn = event.target;
                // Desabilita o bot√£o para evitar cliques m√∫ltiplos
                btn.disabled = true;
                // Atualiza o texto do bot√£o para indicar carregamento
                btn.innerHTML = 'üé® Preparando sua tela...';
                
                // Faz uma requisi√ß√£o POST para a API criar um novo jogador
                const response = await fetch('/api/player/create', {
                    method: 'POST', // M√©todo HTTP POST
                    headers: {'Content-Type': 'application/json'}, // Define o tipo de conte√∫do como JSON
                    body: JSON.stringify({name}) // Envia o nome do jogador em formato JSON
                });

                // Converte a resposta da API em objeto JavaScript
                const data = await response.json();
                
                // Salva o ID do jogador no localStorage do navegador
                localStorage.setItem('inkly_player_id', data.player_id);
                // Salva a prefer√™ncia de m√∫sica no localStorage
                localStorage.setItem('inkly_music', musicPlaying);
                
                // Redireciona para a p√°gina do jogo com o ID do jogador na URL
                window.location.href = `/game?player_id=${data.player_id}`;
            } catch (error) {
                // Se houver algum erro na requisi√ß√£o, exibe mensagem amig√°vel
                alert('Ops! Algo deu errado. Tente novamente! üôè');
                // Reabilita o bot√£o para permitir nova tentativa
                btn.disabled = false;
                // Restaura o texto original do bot√£o
                btn.innerHTML = 'üöÄ Come√ßar a Desenhar!';
            }
        }

        // Adiciona listener para detectar quando a tecla Enter √© pressionada no campo de nome
        document.getElementById('playerName').addEventListener('keypress', (e) => {
            // Se a tecla pressionada for Enter, inicia o jogo
            if (e.key === 'Enter') startGame();
        });
    </script>
</body>
</html>
